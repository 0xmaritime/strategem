<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strategem V2 - Decision-Bound Analysis</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <style>
        .disclaimer-banner {
            background: #000000;
            color: #ffffff;
            padding: 1rem;
            margin: 1rem 0;
            border: 2px solid #000000;
        }
        .disclaimer-banner h3 {
            margin: 0 0 0.5rem 0;
            font-size: 1rem;
        }
        .disclaimer-banner p {
            margin: 0;
            font-size: 0.9rem;
        }
        .v2-features {
            background: #f5f5f5;
            border: 2px solid #000000;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .v2-features ul {
            margin: 0.5rem 0;
            padding-left: 1.5rem;
        }
        .v2-features li {
            margin-bottom: 0.5rem;
        }
        .required-field {
            position: relative;
        }
        .required-field::after {
            content: '*';
            color: red;
            font-weight: 700;
            margin-left: 0.2rem;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 1.5rem;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Strategem V2 <span style="background: #000000; color: #ffffff; padding: 0.2rem 0.5rem; font-size: 0.7rem; margin-left: 0.5rem;">DECISION-BOUND</span></h1>
            <p class="subtitle">Option-Aware Analysis | Cross-Framework Tension Mapping | Sensitivity Triggers</p>
            <nav>
                <a href="/" class="back-link">‚Üê Version Selection</a>
                <a href="/analyses?version=v2">V2 Analyses</a>
            </nav>
        </header>

        <main>
            <div class="disclaimer-banner">
                <h3>‚ö†Ô∏è V2 Requirements</h3>
                <p><strong>V2 requires explicit decision context and options.</strong> These are <strong>not optional</strong>. All frameworks will analyze each option explicitly.</p>
            </div>

            <div class="v2-features">
                <h3>V2 Key Features</h3>
                <ul>
                    <li><strong>Decision-Bound:</strong> Decision question and options are required inputs</li>
                    <li><strong>Option-Aware:</strong> All frameworks must analyze each option explicitly (no system-level claims)</li>
                    <li><strong>Tension Mapping:</strong> Explicit cross-framework tension identification (no aggregation, no reconciliation)</li>
                    <li><strong>Sensitivity Triggers:</strong> Identification of unknowns that would change assessments with inquiry prompts</li>
                    <li><strong>Structured Artefacts:</strong> JSON-native, versioned outputs with content hashes</li>
                </ul>
            </div>

            <section class="intro">
                <h2>Analyze a Target System (V2)</h2>
                <p>Provide Problem Context Materials and explicit decision context. The system produces <strong>option-aware reasoned artifacts</strong> highlighting structural differences, cross-framework tensions, and sensitivity triggers.</p>
            </section>

            <div class="upload-options">
                <div class="upload-section">
                     <h3>Option 1: Paste Text</h3>
                     <form action="/analyze/text" method="post" id="text-form">
                          <textarea
                              name="text"
                              placeholder="Paste Problem Context Material here: target system description, operating environment information, objectives, constraints, or any relevant context..."
                              rows="15"
                              required
                          ></textarea>

                          <div class="decision-focus-section" style="margin: 1.5rem 0; padding: 1rem; border: 2px solid #000000; background: #f5f5f5;">
                              <h4 style="margin-bottom: 1rem;">üéØ Decision Context <span style="color: red; font-weight: 700;">(REQUIRED)</span></h4>
                              <p style="font-size: 0.9rem; margin-bottom: 1rem; color: #000000; font-weight: 700;">V2 requires explicit decision question and options (minimum 2)</p>

                              <div style="margin-bottom: 1rem;">
                                  <label class="required-field" style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Decision Question</label>
                                  <input type="text" name="decision_question" placeholder="e.g., Should we enter the European market?" style="width: 100%; padding: 0.5rem; border: 2px solid #000000;" required>
                              </div>

                              <div style="margin-bottom: 1rem;">
                                  <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Decision Type</label>
                                  <select name="decision_type" style="width: 100%; padding: 0.5rem; border: 2px solid #000000;">
                                      <option value="explore">Explore</option>
                                      <option value="compare" selected>Compare</option>
                                      <option value="stress_test">Stress Test</option>
                                  </select>
                              </div>

                              <div style="margin-bottom: 1rem;">
                                  <label class="required-field" style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Options (comma-separated, minimum 2)</label>
                                  <input type="text" name="options" placeholder="e.g., Enter European market, Focus on domestic growth, Partner with local firm" style="width: 100%; padding: 0.5rem; border: 2px solid #000000;" required>
                              </div>
                          </div>

                          <input type="hidden" name="version" value="v2">

                          <button type="submit" class="btn btn-primary">Run V2 Analysis</button>
                     </form>
                </div>

                <div class="divider">OR</div>

                <div class="upload-section">
                     <h3>Option 2: Upload File</h3>
                     <form action="/analyze/file" method="post" enctype="multipart/form-data" id="upload-form">
                          <div class="file-input-wrapper">
                              <input
                                  type="file"
                                  name="file"
                                  id="upload-file"
                                  accept=".txt,.md"
                                  required
                              >
                              <label for="upload-file" class="file-label">
                                  <span class="file-icon">üìÑ</span>
                                  <span class="file-text">Choose a file...</span>
                              </label>
                          </div>
                          <p class="file-types">Accepted: .txt, .md (Problem Context Materials)</p>

                          <div class="decision-focus-section" style="margin: 1.5rem 0; padding: 1rem; border: 2px solid #000000; background: #f5f5f5;">
                              <h4 style="margin-bottom: 1rem;">üéØ Decision Context <span style="color: red; font-weight: 700;">(REQUIRED)</span></h4>
                              <p style="font-size: 0.9rem; margin-bottom: 1rem; color: #000000; font-weight: 700;">V2 requires explicit decision question and options (minimum 2)</p>

                              <div style="margin-bottom: 1rem;">
                                  <label class="required-field" style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Decision Question</label>
                                  <input type="text" name="decision_question" placeholder="e.g., Should we enter the European market?" style="width: 100%; padding: 0.5rem; border: 2px solid #000000;" required>
                              </div>

                              <div style="margin-bottom: 1rem;">
                                  <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Decision Type</label>
                                  <select name="decision_type" style="width: 100%; padding: 0.5rem; border: 2px solid #000000;">
                                      <option value="explore">Explore</option>
                                      <option value="compare" selected>Compare</option>
                                      <option value="stress_test">Stress Test</option>
                                  </select>
                              </div>

                              <div style="margin-bottom: 1rem;">
                                  <label class="required-field" style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Options (comma-separated, minimum 2)</label>
                                  <input type="text" name="options" placeholder="e.g., Enter European market, Focus on domestic growth, Partner with local firm" style="width: 100%; padding: 0.5rem; border: 2px solid #000000;" required>
                              </div>
                          </div>

                          <input type="hidden" name="version" value="v2">

                          <button type="submit" class="btn btn-primary">Run V2 Analysis</button>
                     </form>
                </div>
            </div>

            <section class="info">
                <h3>What to Expect (V2)</h3>
                <div class="features">
                    <div class="feature">
                        <h4>üéØ Option-Aware Analysis</h4>
                        <p>Every structural force, system dynamic, and analytical claim must explicitly state which options it affects. No system-level or "all options" claims are allowed.</p>
                    </div>
                    <div class="feature">
                        <h4>üó∫ Cross-Framework Tension Mapping</h4>
                        <p>Explicit identification of agreement, tension, and contradiction between frameworks. The system does NOT aggregate or reconcile - tensions are surfaced for human resolution.</p>
                    </div>
                    <div class="feature">
                        <h4>üìä Sensitivity Triggers</h4>
                        <p>First-class identification of unknowns and assumptions that would materially change the assessment. Includes inquiry prompts for evidence gathering.</p>
                    </div>
                    <div class="feature">
                        <h4>üìã Structured JSON Artefacts</h4>
                        <p>Versioned outputs with content hashes for integrity verification. Multiple artefact types: option reports, tension maps, assumption dependencies.</p>
                    </div>
                </div>
            </section>

            <section class="info">
                <h3>System Boundaries (V2)</h3>
                <div style="background: #f5f5f5; padding: 1rem; border: 2px solid #000000; margin-top: 1rem;">
                    <p><strong>V2 does NOT:</strong></p>
                    <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                        <li>Output decisions or recommendations</li>
                        <li>Rank, score, or compare options</li>
                        <li>Aggregate or reconcile framework tensions</li>
                        <li>Optimize objectives or outcomes</li>
                        <li>Provide investment or action advice</li>
                        <li>Validate against external reality</li>
                        <li>Learn from past cases</li>
                    </ul>
                    <p style="margin-top: 1rem; font-size: 0.9rem;">
                        <strong>Known Limitations:</strong> Analysis quality depends on Problem Context Materials quality. No ground truth. No domain authority. Framework disagreement is valid.
                    </p>
                </div>
            </section>
        </main>

        <footer>
            <p>Strategem V2.0.0-dev - Decision-Bound Reasoning Scaffold | Not an oracle</p>
        </footer>
    </div>

    <style>
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        .loading-overlay.active {
            display: flex;
        }
        .loading-content {
            background: #ffffff;
            padding: 3rem;
            border: 4px solid #000000;
            text-align: center;
            max-width: 500px;
        }
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 6px solid #f3f3f3;
            border-top: 6px solid #000000;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1.5rem auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .loading-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: #000000;
        }
        .loading-message {
            font-size: 1rem;
            color: #666;
            margin-bottom: 1rem;
        }
        .loading-steps {
            text-align: left;
            margin-top: 1.5rem;
            padding-left: 0.5rem;
        }
        .loading-step {
            padding: 0.5rem 0;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #999;
        }
        .loading-step.active {
            color: #000000;
            font-weight: 600;
        }
        .loading-step.completed {
            color: #000000;
            text-decoration: line-through;
        }
        .loading-step.completed::before {
            content: '‚úì';
        }
        .loading-step.active::before {
            content: '‚ü≥';
            animation: spin 1s linear infinite;
            display: inline-block;
        }
        .loading-step::before {
            margin-right: 0.5rem;
        }
    </style>
    <script>
        // Simple file input label update - only for text form
        const textFileInput = document.querySelector('#text-form #file');
        if (textFileInput) {
            textFileInput.addEventListener('change', function(e) {
                const fileName = e.target.files[0]?.name || 'Choose a file...';
                const textFileLabel = document.querySelector('#text-form .file-text');
                if (textFileLabel) {
                    textFileLabel.textContent = fileName;
                }
            });
        }

        // Simple file input label update - only for file upload form
        const uploadFileInput = document.querySelector('#upload-form #file');
        if (uploadFileInput) {
            uploadFileInput.addEventListener('change', function(e) {
                const fileName = e.target.files[0]?.name || 'Choose a file...';
                const uploadFileLabel = document.querySelector('#upload-form .file-text');
                if (uploadFileLabel) {
                    uploadFileLabel.textContent = fileName;
                }
            });
        }

        // Show detailed loading overlay when forms are submitted
        document.querySelectorAll('form').forEach(form => {
            form.addEventListener('submit', function(e) {
                const loadingOverlay = document.querySelector('.loading-overlay');
                if (loadingOverlay) {
                    loadingOverlay.classList.add('active');
                    // Animate through steps with timing that reflects actual framework execution
                    const steps = loadingOverlay.querySelectorAll('.loading-step');
                    let currentStep = 0;
                    
                    const animateStep = () => {
                        if (currentStep > 0) {
                            steps[currentStep - 1].classList.remove('active');
                            steps[currentStep - 1].classList.add('completed');
                        }
                        if (currentStep < steps.length) {
                            steps[currentStep].classList.add('active');
                            // Different timing for different steps to reflect reality
                            // Validate: 1s
                            // Run frameworks (option-aware): 15-20s (multiple LLM calls)
                            // Map tensions: 2-3s
                            // Generate artefacts: 2-3s
                            // Finalize: 1s
                            const timings = [1000, 18000, 2500, 2500, 1000];
                            const timing = timings[currentStep] || 2000;
                            currentStep++;
                            setTimeout(animateStep, timing);
                        }
                    };
                    setTimeout(animateStep, 500);
                }
            });
        });
    </script>

    <div class="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-title">Running V2 Analysis</div>
            <div class="loading-message">Decision-bound analysis with option-aware frameworks...</div>
            <div class="loading-steps">
                <div class="loading-step">Validating decision context</div>
                <div class="loading-step">Running V2 frameworks (option-aware)</div>
                <div class="loading-step">Mapping cross-framework tensions</div>
                <div class="loading-step">Generating artefacts</div>
                <div class="loading-step">Finalizing V2 analysis</div>
            </div>
        </div>
    </div>
</body>
</html>
